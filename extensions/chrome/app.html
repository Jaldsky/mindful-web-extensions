<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="app.title">Mindful Web</title>
    <script>
        // Apply theme immediately to prevent flash - must be synchronous
        try {
            // Try to get theme from localStorage cache first (instant)
            const cachedTheme = localStorage.getItem('mindful_theme_cache');
            if (cachedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
            
            // Then update from chrome.storage (async, for next time)
            if (typeof chrome !== 'undefined' && chrome.storage && chrome.storage.local) {
                chrome.storage.local.get(['mindful_theme'], function(result) {
                    const theme = result['mindful_theme'] || 'light';
                    localStorage.setItem('mindful_theme_cache', theme);
                    if (theme === 'dark') {
                        document.documentElement.setAttribute('data-theme', 'dark');
                    } else {
                        document.documentElement.removeAttribute('data-theme');
                    }
                });
            }
        } catch (e) {
            console.error('Theme initialization error:', e);
        }
    </script>
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/app.css">
</head>
<body>
    <div class="header">
        <div class="logo">ðŸ§˜ Mindful Web</div>
        <div class="subtitle" data-i18n="app.subtitle">Track your attention</div>
    </div>
    
    <div class="status">
        <div class="status-item">
            <span class="status-label" data-i18n="app.status.connection">Connection:</span>
            <span class="status-value" id="connectionStatus" data-i18n="app.status.checking">Checking...</span>
        </div>
        <div class="status-item">
            <span class="status-label" data-i18n="app.status.tracking">Tracking:</span>
            <span class="status-value" id="trackingStatus" data-i18n="app.status.active">Active</span>
        </div>
    </div>
    
    <div class="stats">
        <div class="stats-title" data-i18n="app.stats.title">Today's Activity</div>
        <div class="stats-item">
            <span data-i18n="app.stats.eventsTracked">Events tracked:</span>
            <span id="eventsCount">0</span>
        </div>
        <div class="stats-item">
            <span data-i18n="app.stats.domainsVisited">Domains visited:</span>
            <span id="domainsCount">0</span>
        </div>
        <div class="stats-item">
            <span data-i18n="app.stats.queueSize">Queue size:</span>
            <span id="queueSize">0</span>
        </div>
    </div>
    
    <div class="actions">
        <button class="settings-btn" id="openSettings" data-i18n="app.buttons.settings">Settings</button>
        <button class="test-btn" id="testConnection" data-i18n="app.buttons.testConnection">Test Connection</button>
    </div>
    
    <!--suppress HtmlUnresolvedFile -->
    <script src="app.bundle.js"></script>
</body>
</html>
